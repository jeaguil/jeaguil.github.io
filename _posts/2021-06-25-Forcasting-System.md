---
layout: post
title: Predicting the Power Output of a Solar Farm using Data Mining
category: showcases
---

Code for the project can be found [here.](https://github.com/jeaguil/svfa){:target="_blank"}

## Table of Contents

- [Implemented Methods](#implemented-methods)
- [Evaluation Results](#evaluation-results)

---
{: data-content="introduction"}

Abstract - The solar energy industry has undergone significant modernization in the past decade, but the supply of renewable energy remains unpredictable. The solar energy business faces significant challenges with the supply and demand of energy infrastructure. The goal is to improve business efficiency by predicting the power generated by a solar power plant farm, thereby improving the supply, demand, and prices of a volatile business model.

The key idea is to provide a solar energy forecasting system for a solar power plant farm using data mining fundamentals. Given a small set of weather variable conditions from the European Centre for Medium-range Weather Forecast (ECMWF), the system aims to predict the power generated by a power plant 24 hours later and quantify the uncertain future.

Exact Problem - "In today's energy infrastructure, energy prices have become very unpredictable, and business models are trying to modernize the industry to solve this key issue. The idea is to create a decision-making model that can quantify the solar power output of a solar farm. Under certain weather conditions, the solar power plant farm needs to perform to an expectation. This will help to better understand and quantify the uncertainties of the energy industry.

The key challenge in constructing a decision-making process is understanding how the power output of a solar power plant is affected by different weather conditions, especially when taking into account the number of solar power plants and the overall size of the solar farm. A probabilistic forecast can take various forms, including handling the introductory data to feed the model and choosing the most optimal regression classifier. The forecasting combination of multiple classifiers can also be challenging. How to combine multiple probabilistic forecasts to generate a single, more accurate forecast and what are the many possible combinations? These are the general problems in constructing a solar power generation forecasting system."

---
{: data-content="data in detail"}

[Full CSV of data from European Centre for Medium-range Weather Forcast](https://raw.githubusercontent.com/jeaguil/svfa/master/data/ecmwf_solar.csv){:target="_blank"}

Data includes weather forecast for 12 weather variables.
Obtained from ECMWF

Hourly measurements for each solar power plant from
2012/04/01 01:00 to 2014/07/01 00:00

ZoneId are power plants identified from 1 to 3.
Power attributes records the hourly solar power generation.

VAR 78: Total column liquid water (tclw) measured in kg m^-2
    Vertical Integral of cloud liquid water content.

Var 79: Total coluimn ice water (tciw) measured in kg m^-2
    Vertical Integral of cloud ice water content.

Var 134: Surface pressure (SP) measure in Pa

Var 157: Relative humidity at 1000 mbar (r) measured in %
    Relative humidity is defined with respect to saturation of
    the mixed phase, i.e., with respect to saturation over ice
    below -23 C and with respect to saturation over water
    above 0 C. In the regime in between, a quadratic interpolation
    is applied.

Var 164: Total cloud cover (TCC) measured 0-1
    Total cloud cover derived from model levels using the
    model's overlap assumption.

Var 165: 10-metre U wind component (10u) measured in m s^-1

Var 166: 10-metre V wind component (10v) measured in m s^-1

Var 167: 2-metre temperature (2T) measured in K

Var 169: Surface solar rad down (SSRD) measured in J m^-2
    Accumulated field.

Var 175: Surface thermal rad down (STRD) measured in J m^-2
    Accumulated field.

Var 178: Top net solar rad (TSR) measured in J m^-2
    Net solar radiation at the top of the atmospher.
    Accumulated field.

Var 228: Total precipitation (TP) measured in m
    Convective precipitation + stratiform precipitation
    (CP + LSP). Accumulated field.

---

## [Implemented Methods](#implemented-methods)

__Dataset splitting__ - I split the provided dataset into two sets for training and testing. As the dataset included measurements at hourly intervals between 2012 and 2014, the training set contains data from 2012/04/01 01:00 to 2013/07/01 00:00. The testing set consists of data from 2013/07/01 01:00 to 2014/07/01 00:00.

__Feature selection__ - In this section, I will discuss my approach to reducing the number of attributes in the training dataset and determining the most important weather variables in a predictive model. I used the twelve weather forecast variables provided in the ECMWF dataset to find a correlation between their individual values and the power output several hours later. Then, I calculated the correlation coefficients from the correlation matrix to scale the weather variables based on their true effectiveness on the power output. This ensured that the model takes into account the most important weather variables in quantifiable regression. If the correlation coefficient of a weather variable is negative, the ensemble classifier decreases the variable by some factor since it does not provide a great impact on the power output. The relative humidity measured in percentage proved to be the most negatively correlated to the power output 24 hours later, followed by the surface thermal radiation down measurement. On the other hand, the 2-meter temperature measured in Kelvin proved to be the most positively correlated, while the 10-meter wind component was the second most positively correlated. Using the correlation coefficients of these weather variables, I scaled the training dataset accordingly for the model.

__Data Preprocessing__ - An important step in data mining is producing a probabilistic model, which involves taking the raw data from the training dataset and transforming it into a format that better fits the model that solves the general solution. To achieve this, each weather variable in the training dataset was standardized to remove the mean and scale the variance. This was done using Eq. (1), where u is the mean of the training samples, X is the record in the dataset consisting of all weather variables and the power output at that measured hour, and s is the standard deviation of the training samples.

(1)     Standardization = (X-u)s

Each standard score was computed for each record in the dataset and all weather variables were normalized for a better format.

__Model Selection__ - Since there were over 59,000 records in the dataset distributed among three solar power farms, only a few features were considered important, given the variable correlations discussed before. Initially, I designed a probabilistic linear model, specifically a Lasso linear model, known to perform well with a large dataset with only a few important features. After evaluating the Lasso model's performance, I switched to an ensemble model and implemented a random forest regressor instead. This led to an improvement in predictive accuracy during training and overall control overfitting.

__Generalization ability__ - To evaluate the performance of the random forest regressor, I implemented 5-fold cross validation. This technique allowed me to find the optimal hyperparameters for the model, thus ensuring its accuracy. For each set of hyperparameters, I performed cross validation on the retrained model using the training data. Finally, I evaluated the performance of the retrained model on the testing dataset and observed optimal results.

---

## [Evaluation Results](#evaluation-results)

__Experimental Results__ - Table 1 shows the experimental results of the probabilistic forecasting model approach. This shows the mean absolute error and root mean square error using the predicted power 24 hours later and the actual power. These measurements show the paired observations for predicted values.

Table 1: Model Evaluation results

Zone ID | 1 | 2 | 3 | Overall
--- | --- | --- | --- | ---
Mean Absolute Error | 0.05726 | 0.0635 | 0.0645 | 0.0617
Root Mean Squared Error | 0.1157 | 0.1230 | 0.1249 | 0.1212
